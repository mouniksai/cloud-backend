// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL") // Optional: Useful for Supabase
}

// 1. Mock Government Registry Model
model GovtRegistry {
  citizenId    String   @id @unique @map("citizen_id") @db.VarChar(12)
  fullName     String   @map("full_name") @db.VarChar(100)
  dob          DateTime @db.Date
  state        String?  @db.VarChar(50)
  gender       String?  @db.VarChar(10)
  email        String   @unique @db.VarChar(100)
  mobile       String   @unique @db.VarChar(15)
  photoUrl     String?  @map("photo_url")
  isRegistered Boolean  @default(false) @map("is_registered")

  // Relation: One Citizen can have one User account
  User User?

  @@map("govt_registry") // Maps to the actual SQL table name
}

// 2. App User Model
model User {
  userId       String   @id @default(uuid()) @map("user_id") @db.Uuid
  username     String   @unique @db.VarChar(50)
  passwordHash String   @map("password_hash")
  role         String   @default("voter") @db.VarChar(20)
  createdAt    DateTime @default(now()) @map("created_at")

  // Relation Field (Foreign Key)
  citizenId String       @unique @map("citizen_id")
  citizen   GovtRegistry @relation(fields: [citizenId], references: [citizenId])

  @@map("users")
}